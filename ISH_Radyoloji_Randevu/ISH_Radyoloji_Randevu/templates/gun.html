{% extends 'base.html' %}
{% block title %}Gün Detayı: {{ tarih }}{% endblock %}
{% block content %}
<div class="detail-container">
    <h2>{{ tarih }} Günü İşlemleri</h2>
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="flash-{{ category }}">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    {% if islemler %}
        <ul class="daily-list">
            {% for islem in islemler %}
            <li class="islem-item">
                <div class="islem-info">
                    <strong>{{ islem.hasta_adi }}</strong> - {{ islem.islem_adi }}
                    <span class="tag" style="background-color: {{ islem.to_dict().color }}">{{ islem.anestezi_tipi }}</span>
                    {% if islem.notlar %}
                        <p class="note-display"><strong>Not:</strong> {{ islem.notlar }}</p>
                    {% endif %}
                </div>
                {% if current_user.role in ['admin', 'doktor'] %}
                <div class="islem-actions">
                    <a href="{{ url_for('duzenle', islem_id=islem.id) }}" class="button-edit">Düzenle</a>
                    <form action="{{ url_for('sil', islem_id=islem.id) }}" method="post" onsubmit="return confirm('Bu randevuyu kalıcı olarak silmek istediğinizden emin misiniz?');">
                        <button type="submit" class="button-delete">Sil</button>
                    </form>
                </div>
                {% endif %}
            </li>
            {% endfor %}
        </ul>
        <div class="total-time">
            <strong>Toplam Tahmini İşlem Süresi:</strong> {{ toplam_sure }} dakika
        </div>
    {% else %}
        <p>Bu gün için planlanmış bir işlem bulunmamaktadır.</p>
    {% endif %}
    <a href="{{ url_for('ana_sayfa') }}" class="button-cancel" style="width: auto; margin-top: 20px;">Takvime Geri Dön</a>
</div>
{% endblock %}